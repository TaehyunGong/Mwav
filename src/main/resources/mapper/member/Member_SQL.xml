<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<!-- #은 ' ' string // $ 은 숫자 ' ' 없음 -->
<mapper namespace="member">
	
	<!-- /*========================================등록========================================*/ -->
	<insert id="insertMbrForm" parameterType="hashmap">
		<![CDATA[
	INSERT INTO Member_tbl 
		Values(#{member_id}, #{mbrLoginId}, #{mbrLoginPw}, #{mbrTempLoginPw}, #{mbrFirstName}, #{mbrLastName}, #{mbrMiddleName}, #{mbrEmail}, #{mbrCellPhone}, #{mbrAddrFlag}, #{mbrZipcode}, #{mbrAddress})
		]]>
	</insert>
	
	<insert id="insertMemberValue_tbl" parameterType="hashmap">
		<![CDATA[
	INSERT INTO MemberValue_tbl Values(#{member_id},null,null,null,null,null,null,null,null,null,null,now(),null,null,null,null,null,null)
		]]>
	</insert>
	
	<!-- /*========================================보기========================================*/ -->
	<select id="selectMbrView" parameterType="hashmap" resultType="hashmap">
		<![CDATA[
	      select * from Member_tbl where member_id= #{member_id}
		]]>
	</select>
	
	<!-- /*========================================수정========================================*/ -->
	<select id="updateMbrForm" parameterType="hashmap" resultType="hashmap">
		<![CDATA[
	      select * from Member_tbl where member_id= #{member_id}
		]]>
	</select>
	<update id="updateProMbrForm" parameterType="hashmap" >
		<![CDATA[
	       update Member_tbl set mbrFirstName=#{mbrFirstName}, mbrMiddleName= #{mbrMiddleName}, mbrLastName= #{mbrLastName} , mbrEmail= #{mbrEmail}, mbrCellPhone= #{mbrCellPhone}where member_id = #{member_id}
		]]>
	</update>
	
	<update id="updateMbrLoginPw" parameterType="hashmap" >
		<![CDATA[
		UPDATE member_tbl SET mbrLoginPw = #{mbrLoginPw} WHERE mbrTempLoginPw = #{imsi_mbrLoginPw}
		]]>
	</update>
	
	<update id="updateMbrTempLoginPw" parameterType="hashmap"> 
		<![CDATA[
		UPDATE Member_tbl SET mbrLoginPw=null, mbrTempLoginPw = #{mbrTempLoginPw} WHERE mbrEmail = #{mbrEmail} and mbrLoginId = #{mbrLoginId}
		]]>
	</update>
	
	<!--/*========================================리스트(SelectOne, SelectList 순)========================================*/-->
	
	<select id="selectOneMbrLoginIdCheck" parameterType="string" resultType="string">
		<![CDATA[
	      select mbrLoginId from Member_tbl where mbrLoginId = #{mbrLoginId};
		]]>
	</select>
	
    <select id="selectOneMbrLoginIdSeek" parameterType="hashmap" resultType="hashmap">
		<![CDATA[
		select mbrLoginId from Member_tbl where mbrCellPhone = #{mbrCellPhone} and mbrEmail = #{mbrEmail}
		]]>
	</select>
	
	 <select id="selectOneMbrTempLoginPwSeek" parameterType="hashmap" resultType="string">
		<![CDATA[
		select mbrTempLoginPw from Member_tbl where mbrTempLoginPw = #{imsiPW}
		]]>
	</select>
	
	<!--/*========================================삭제========================================*/-->
	<update id="deleteMbrDelete" parameterType="hashmap"> 
		<![CDATA[		
		update MemberValue_tbl set mbrLeaveDt=NOW() where member_id = (SELECT member_id FROM member_tbl where mbrLoginPw = #{mbrLoginPw} and member_id = #{member_id})
		]]>
	</update>
	
	<select id="selectListZcGunGuSeek" parameterType="String" resultType="String">
		<![CDATA[
		select distinct(zcSiGunGuName) from ZipCodeGunGuSeek_tbl where zcSiDoName = #{zcSiDoName}
		]]>
	</select>
	
	<select id="post_zcRoadName" parameterType="hashmap" resultType="hashmap">
		<![CDATA[
		SELECT ZipCode_tbl.zcSiDoName,
       ZipCode_tbl.zcSiGunGuName,
       ZipCode_tbl.zcLegalEupMyeonDongName,
       ZipCode_tbl.zcLegalRiName,
       ZipCode_tbl.zcJiBunMain,
       ZipCode_tbl.zcJiBunSub,
       ZipCode_tbl.zcRoadName,
       ZipCode_tbl.zcBuildingMainNo,
       ZipCode_tbl.zcBuildingSubNo,
       ZipCode_tbl.zcBuildingMgrNo,
       ZipCode_tbl.zcZipCode
  FROM mwav.zipcode_tbl zipcode_tbl
 WHERE ZipCode_tbl.zcSiDoName = #{zcSiDoName} and ZipCode_tbl.zcSiGunGuName = #{zcSiGunGuName} and ZipCode_tbl.zcRoadName = #{zcRoadName} and ZipCode_tbl.zcBuildingMainNo = #{zcBuildingMainNo}
		]]>
	</select>
	<!-- select * from ZipCode_tbl where zcSiDoName = #{zcSiDoName} and zcSiGunGuName = #{zcSiGunGuName} and zcRoadName = #{zcRoadName} and zcBuildingMainNo = #{zcBuildingMainNo}-->
	
	<select id="post_zcLegalEupMyeonDongName" parameterType="hashmap" resultType="hashmap">
		<![CDATA[
		
		SELECT ZipCode_tbl.zcSiDoName,
       ZipCode_tbl.zcSiGunGuName,
       ZipCode_tbl.zcLegalEupMyeonDongName,
       ZipCode_tbl.zcLegalRiName,
       ZipCode_tbl.zcJiBunMain,
       ZipCode_tbl.zcJiBunSub,
       ZipCode_tbl.zcRoadName,
       ZipCode_tbl.zcBuildingMainNo,
       ZipCode_tbl.zcBuildingSubNo,
       ZipCode_tbl.zcBuildingMgrNo,
       ZipCode_tbl.zcZipCode
  FROM mwav.zipcode_tbl zipcode_tbl
 WHERE ZipCode_tbl.zcSiDoName = #{zcSiDoName} and ZipCode_tbl.zcSiGunGuName = #{zcSiGunGuName} and ZipCode_tbl.zcLegalEupMyeonDongName = #{zcLegalEupMyeonDongName} and ZipCode_tbl.zcJiBunMain = #{zcJiBunMain}
		
		]]>
	</select>
	<!-- select * from ZipCode_tbl where zcSiDoName = #{zcSiDoName} and zcSiGunGuName = #{zcSiGunGuName} and zcLegalEupMyeonDongName = #{zcLegalEupMyeonDongName} and zcJiBunMain = #{zcJiBunMain}-->	
	<select id="post_zcBuildingBook" parameterType="hashmap" resultType="hashmap">
		<![CDATA[
			SELECT ZipCode_tbl.zcSiDoName,
       ZipCode_tbl.zcSiGunGuName,
       ZipCode_tbl.zcLegalEupMyeonDongName,
       ZipCode_tbl.zcLegalRiName,
       ZipCode_tbl.zcJiBunMain,
       ZipCode_tbl.zcJiBunSub,
       ZipCode_tbl.zcRoadName,
       ZipCode_tbl.zcBuildingMainNo,
       ZipCode_tbl.zcBuildingSubNo,
       ZipCode_tbl.zcBuildingMgrNo,
       ZipCode_tbl.zcZipCode
  FROM mwav.zipcode_tbl zipcode_tbl
 WHERE ZipCode_tbl.zcSiDoName = #{zcSiDoName} and ZipCode_tbl.zcSiGunGuName = #{zcSiGunGuName} and ZipCode_tbl.zcBuildingBook = #{zcBuildingBook} 

		]]>
	</select>
	<!--select * from ZipCode_tbl where zcSiDoName = #{zcSiDoName} and zcSiGunGuName = #{zcSiGunGuName} and zcBuildingBook = #{zcBuildingBook} -->
	
    <!--
select * from postcodebuildinfo_tbl where 시도명 = '강원도' and 시군구명 = '춘천시' and 법정읍면동명 = '봉의동' and 지번본번 = '1'
select * from postcodebuildinfo_tbl where 시도명 = '강원도' and 시군구명 = '춘천시' and 도로명 = '봉의산길' and 건물본번 = '28'
select * from postcodebuildinfo_tbl where 시도명 = '서울특별시' and 시군구명 = '강동구' and 건축물대장 건물명 = '힐링하우스'   
    -->
    <select id="selectNextPk" parameterType="hashmap" resultType="hashmap">
		<![CDATA[
	       select IFNULL(max(member_id+1) , 100000) AS member_id from Member_tbl 
		]]>
	</select>
	
    
	<select id="selectLogin" parameterType="hashmap" resultType="hashmap">
		<![CDATA[
		SELECT a.mbrLoginPw, a.mbrLoginId, a.member_id, b.mbrLeaveDt
		FROM Member_tbl a, MemberValue_tbl b
	    WHERE a.member_id = b.member_id and mbrLoginId = #{mbrLoginId} 		
		]]>
	</select>
		
</mapper>

